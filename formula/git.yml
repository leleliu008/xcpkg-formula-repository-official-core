summary: A free and open source distributed version control system with speed and efficiency
web-url: https://git-scm.com/
git-url: https://github.com/git/git
src-url: https://www.kernel.org/pub/software/scm/git/git-2.53.0.tar.xz
src-sha: 5818bd7d80b061bbbdfec8a433d609dc8818a05991f731ffc4a561e2ca18c653
license: GPL-2.0-only
dep-pkg: libpcre2 libexpat libcurl libintl libz
dep-lib: libcurl
dep-upp: gettext-tools
binbstd: 1

prepare: |
    export NO_FINK=1
    export NO_DARWIN_PORTS=1
    export NO_INSTALL_HARDLINKS=1

    isCrossBuild || return 0

    # to bypass git error: cannot run test program while cross compiling
    export ac_cv_fread_reads_directories=yes
    export ac_cv_header_libintl_h=yes
    export ac_cv_iconv_omits_bom=no
    export ac_cv_snprintf_returns_bogus=no

install: |
    configure \
        --with-zlib="$libz_INSTALL_DIR" \
        --with-curl="$libcurl_INSTALL_DIR" \
        --with-expat="$libexpat_INSTALL_DIR" \
        --with-iconv="$libiconv_INSTALL_DIR" \
        --with-openssl="$openssl_dev_INSTALL_DIR" \
        --with-libpcre2="$libpcre2_INSTALL_DIR" \
        --without-tcltk

bindenv: |
    GIT_EXEC_PATH=%s/libexec/git-core
    GIT_TEMPLATE_DIR=%s/share/git-core/templates
    GIT_CONFIG_NOSYSTEM=1
