summary: A small and embeddable JavaScript engine
git-url: https://github.com/bellard/quickjs
web-url: https://bellard.org/quickjs
src-url: https://bellard.org/quickjs/quickjs-2025-09-13-2.tar.xz
src-sha: 996c6b5018fc955ad4d06426d0e9cb713685a00c825aa5c0418bd53f7df8b0b4
license: MIT

dopatch: |
    gsed -i \
         -e's|-g||' \
         -e 's|lib/quickjs|lib|g' \
         -e 's|include/quickjs|include|g' Makefile \
         -e 's|$(HOST_CC) $(LDFLAGS)|$(HOST_CC) -B/usr/bin $(LDFLAGS)|' Makefile
    # https://newbedev.com/how-to-specify-alternate-linker-command-when-linking-with-cc

prepare: |
    export HOST_CC="$CC_FOR_BUILD"
    export CC="$CC $CPPFLAGS $CFLAGS $LDFLAGS"

    unset CFLAGS
    unset CPPFLAGS
    unset LDFLAGS

install: |
    gmakew clean
    gmakew install CONFIG_M32= HOST_CC="'$HOST_CC'" CC="'$CC'" "AR=$AR" "STRIP=$STRIP" LDFLAGS=-Wl,-v CROSS_PREFIX=xxx PREFIX="$PACKAGE_INSTALL_DIR"
